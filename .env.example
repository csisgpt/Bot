# =========================
# App
# =========================
NODE_ENV=production
APP_NAME=crypto-signals-bot
TZ=UTC
LOG_LEVEL=info

# API & Worker ports
PORT=3000
WORKER_PORT=3001

# =========================
# Database (PostgreSQL)
# =========================
# Example:
# DATABASE_URL=postgresql://user:pass@host:5432/dbname?sslmode=disable
DATABASE_URL=
PRISMA_LOG_LEVEL=info

# =========================
# Redis
# =========================
# Prefer REDIS_URL. If empty, set REDIS_HOST/REDIS_PORT.
# Example:
# REDIS_URL=redis://:password@host:6379/0
REDIS_URL=
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# =========================
# BullMQ / Queue
# =========================
QUEUE_SIGNALS_NAME=signals
QUEUE_CONCURRENCY=5
QUEUE_MARKET_DATA_NAME=market-data
QUEUE_NEWS_NAME=news

# =========================
# Notifications Orchestrator
# =========================
NOTIFICATION_ORCHESTRATOR_ENABLED=true
NOTIF_MODE_DEFAULT=NORMAL
NOTIF_MAX_PER_HOUR_DEFAULT=12
NOTIF_QUIET_HOURS_DEFAULT_ENABLED=true
NOTIF_QUIET_HOURS_DEFAULT_START=23:00
NOTIF_QUIET_HOURS_DEFAULT_END=08:00
NOTIF_COOLDOWN_SIGNALS_DEFAULT=600
NOTIF_COOLDOWN_NEWS_DEFAULT=1800
NOTIF_COOLDOWN_ARB_DEFAULT=300
NOTIF_MIN_CONFIDENCE_DEFAULT=60
NOTIF_DIGEST_ENABLED_DEFAULT=false
NOTIF_DIGEST_TIMES_DEFAULT=09:00,21:00

# Retry/Backoff for telegram send jobs
SIGNALS_TELEGRAM_JOB_ATTEMPTS=5
SIGNALS_TELEGRAM_JOB_BACKOFF_DELAY_MS=3000
SIGNALS_TELEGRAM_JOB_PRIORITY=1

# =========================
# Telegram
# =========================
TELEGRAM_BOT_TOKEN=
TELEGRAM_BOT_ID=
TELEGRAM_BOT_USERNAME=
TELEGRAM_USE_POLLING=false
TELEGRAM_WEBHOOK_URL=
TELEGRAM_WEBHOOK_SECRET=
TELEGRAM_ADMIN_ONLY_GROUP_SETTINGS=true

# Optional owner/admin info
TELEGRAM_OWNER_USER_ID=
TELEGRAM_OWNER_USERNAME=
OWNER_USER_ID=
ADMIN_TEST_TOKEN=

# Targets
TELEGRAM_SIGNAL_CHANNEL_ID=
TELEGRAM_SIGNAL_CHANNEL_USERNAME=
TELEGRAM_SIGNAL_CHANNEL_TITLE=
TELEGRAM_SIGNAL_GROUP_ID=
TELEGRAM_SIGNAL_GROUP_TITLE=

# Telegram message settings
TELEGRAM_PARSE_MODE=HTML
TELEGRAM_DISABLE_WEB_PAGE_PREVIEW=true

# =========================
# Assets / Instruments
# =========================
# CSV list: GOLD,CRYPTO
ASSETS_ENABLED=GOLD,CRYPTO

# CSV list of instruments
GOLD_INSTRUMENTS=PAXGUSDT
CRYPTO_INSTRUMENTS=BTCUSDT,ETHUSDT
DEFAULT_TIMEFRAMES=5m,15m
MONITORING_ENABLED=true
UNIVERSE_DEFAULT_SYMBOLS=BTCUSDT,ETHUSDT,XAUTUSDT
UNIVERSE_MAX_SYMBOLS=100

# Providers enabled (multi-provider)
PROVIDERS_ENABLED=binance,bybit,okx
MARKET_DATA_INGEST_ENABLED=true
MARKET_DATA_TIMEFRAMES=1m
MARKET_DATA_TICKER_TTL_SECONDS=120
LEGACY_CANDLE_COMPAT_ENABLED=true

# Optional override
BINANCE_SYMBOLS=

# =========================
# Price providers & ticker
# =========================
# Allowed examples: BINANCE_SPOT, BINANCE_FUTURES, MANUAL
PRICE_PROVIDER_GOLD=BINANCE_SPOT
PRICE_PROVIDER_CRYPTO=BINANCE_SPOT

PRICE_INGEST_ENABLED=false
# NOTE: In V3 mode (MARKET_DATA_INGEST_ENABLED=true) legacy price ingest is disabled to avoid duplicate WS.
PRICE_TICKER_ENABLED=false
PRICE_TICKER_POST_SECONDS=30
PRICE_TICKER_INSTRUMENTS=PAXGUSDT
PRICE_TICKER_POST_TO_GROUP=true
PRICE_TICKER_POST_TO_CHANNEL=true

# Market data ingest / aggregation (Legacy mode when MARKET_DATA_INGEST_ENABLED=false)
CANDLE_INGEST_ENABLED=true
CANDLE_INGEST_INTERVAL_SECONDS=60
CANDLE_INGEST_CONCURRENCY=5
CANDLE_AGGREGATE_ENABLED=true
CANDLE_AGGREGATE_CONCURRENCY=5
AGG_TIMEFRAMES=5m,15m

# =========================
# Signals Engine
# =========================
SIGNAL_ENGINE_ENABLED=true
SIGNAL_ENGINE_INTERVAL_SECONDS=30
DEFAULT_SIGNAL_TIMEFRAMES=5m,15m
MIN_CANDLES=50
SIGNAL_COOLDOWN_SECONDS=600
SIGNAL_ENGINE_CONCURRENCY=5
SIGNAL_STRATEGY_NAME=MVP_V1
LEGACY_SIGNALS_CRON_ENABLED=false

# =========================
# Binance REST
# =========================
BINANCE_BASE_URL=https://data-api.binance.vision
BINANCE_INTERVAL=15m
BINANCE_KLINES_LIMIT=200
BINANCE_REQUEST_TIMEOUT_MS=10000
BINANCE_WS_URL=wss://stream.binance.com:9443/stream
BINANCE_WS_MINI_TICKER=false

# =========================
# Bybit
# =========================
BYBIT_WS_URL=wss://stream.bybit.com/v5/public/spot
BYBIT_REST_URL=https://api.bybit.com
BYBIT_REST_TIMEOUT_MS=10000
BYBIT_REST_FALLBACK_INTERVAL_SECONDS=60

# =========================
# OKX
# =========================
OKX_REST_URL=https://www.okx.com
OKX_REST_TIMEOUT_MS=10000
OKX_REST_TICKER_INTERVAL_SECONDS=10
OKX_REST_CANDLE_INTERVAL_SECONDS=60
OKX_POLL_INTERVAL_MS=10000
OKX_REST_CONCURRENCY=4
OKX_WS_URL=
OKX_WS_ENABLED=false

# =========================
# KCEX (disabled by default)
# =========================
KCEX_ENABLE=false
KCEX_REST_URL=
KCEX_WS_URL=

# =========================
# Strategies
# =========================
# CSV list
STRATEGIES_ENABLED=ema_rsi,rsi_threshold,breakout,macd

EMA_FAST_PERIOD=12
EMA_SLOW_PERIOD=26

RSI_PERIOD=14
RSI_BUY_THRESHOLD=30
RSI_SELL_THRESHOLD=70

BREAKOUT_LOOKBACK=20

MACD_FAST_PERIOD=12
MACD_SLOW_PERIOD=26
MACD_SIGNAL_PERIOD=9

# Risk levels
ENABLE_RISK_LEVELS=true
ATR_PERIOD=14
SL_ATR_MULTIPLIER=1.5
TP1_ATR_MULTIPLIER=2
TP2_ATR_MULTIPLIER=3

# Dedupe & cooldown
SIGNAL_DEDUPE_TTL_SECONDS=7200
SIGNAL_MIN_COOLDOWN_SECONDS=1

# =========================
# Digest / Reports
# =========================
DIGEST_TIME_UTC=20:00
DIGEST_ENABLED=true
DIGEST_POST_TO_GROUP=true
DIGEST_POST_TO_CHANNEL=false

# =========================
# TradingView Webhook
# =========================
TRADINGVIEW_WEBHOOK_ENABLED=true
TRADINGVIEW_WEBHOOK_SECRET=change-me

# When true, bypass some dedupe behaviour
TRADINGVIEW_SEND_ALL=false

TRADINGVIEW_DEFAULT_ASSET_TYPE=GOLD
TRADINGVIEW_DEFAULT_INSTRUMENT=XAUTUSDT
TRADINGVIEW_DEFAULT_INTERVAL=1s
TRADINGVIEW_DEFAULT_STRATEGY=tradingview

# Optional fallback timeout for price fetch when ingesting alerts
TRADINGVIEW_PRICE_FALLBACK_TIMEOUT_MS=2000

# =========================
# Webhook security
# =========================
WEBHOOK_MAX_BODY_KB=64
RATE_LIMIT_WEBHOOK_RPM=60

# =========================
# TradingView Email (optional)
# =========================
TRADINGVIEW_EMAIL_ENABLED=false
TRADINGVIEW_IMAP_HOST=
TRADINGVIEW_IMAP_USER=
TRADINGVIEW_IMAP_PORT=993
TRADINGVIEW_IMAP_SECURE=true
TRADINGVIEW_IMAP_PASS=
TRADINGVIEW_EMAIL_FOLDER=INBOX
TRADINGVIEW_EMAIL_POLL_SECONDS=30

# =========================
# Arbitrage
# =========================
ARB_ENABLED=true
ARB_SCAN_INTERVAL_SECONDS=5
ARB_STALE_MS=15000
ARB_MIN_SPREAD_PCT=0.2
ARB_MIN_NET_PCT=0.05
ARB_COOLDOWN_SECONDS=60
ARB_DEDUPE_TTL_SECONDS=300
ARB_FUNDING_ENABLED=false
ARB_TRIANGULAR_ENABLED=false
ARB_DEPTH_ENABLED=false
PROVIDER_TAKER_FEE_BPS_BINANCE=10
PROVIDER_TAKER_FEE_BPS_BYBIT=10
PROVIDER_TAKER_FEE_BPS_OKX=10
PROVIDER_TAKER_FEE_BPS_KCEX=10

# =========================
# News
# =========================
NEWS_ENABLED=true
NEWS_FETCH_INTERVAL_MINUTES=5
NEWS_HTTP_TIMEOUT_MS=10000
NEWS_RETRY_ATTEMPTS=3
NEWS_RETRY_BASE_DELAY_MS=500
NEWS_BINANCE_URL=https://www.binance.com/en/support/announcement
NEWS_BYBIT_URL=https://www.bybit.com/en/announcement-info
NEWS_OKX_URL=https://www.okx.com/support/hc/en-us/categories/360000030652

# =========================
# Proxy (optional)
# =========================
HTTP_PROXY=
HTTPS_PROXY=
ALL_PROXY=

# Can be comma separated or single string
NO_PROXY=localhost,127.0.0.1,binance.com,binance.vision

# =========================
# Binance WebSocket (optional)
# =========================
BINANCE_WS_ENABLED=false
BINANCE_WS_BASE_URL=wss://stream.binance.com:9443

# =========================
# Runtime flags
# =========================
RUN_API=true
RUN_WORKER=false
MIGRATE_ON_START=false

# =========================
# Render keepalive (optional)
# =========================
RENDER_KEEPALIVE_ENABLED=false
RENDER_KEEPALIVE_URL=
